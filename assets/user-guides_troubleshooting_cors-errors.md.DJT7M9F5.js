import{_ as s,c as i,o as a,ag as o}from"./chunks/framework.S-Qvb3wi.js";const u=JSON.parse('{"title":"Troubleshooting CORS Errors","description":"","frontmatter":{},"headers":[],"relativePath":"user-guides/troubleshooting/cors-errors.md","filePath":"user-guides/troubleshooting/cors-errors.md"}'),t={name:"user-guides/troubleshooting/cors-errors.md"};function n(r,e,l,p,c,h){return a(),i("div",null,e[0]||(e[0]=[o(`<h1 id="troubleshooting-cors-errors" tabindex="-1">Troubleshooting CORS Errors <a class="header-anchor" href="#troubleshooting-cors-errors" aria-label="Permalink to &quot;Troubleshooting CORS Errors&quot;">​</a></h1><p>Cross-Origin Resource Sharing (CORS) is a security feature that controls how web applications in one domain can request and interact with resources in another. If not configured correctly, you may encounter errors when performing actions like uploading files.</p><p>This guide will help you diagnose and resolve common CORS-related issues.</p><h2 id="symptoms" tabindex="-1">Symptoms <a class="header-anchor" href="#symptoms" aria-label="Permalink to &quot;Symptoms&quot;">​</a></h2><p>You may be experiencing a CORS issue if you see one of the following errors in your browser&#39;s developer console or in the application&#39;s logs:</p><ul><li><code>TypeError: fetch failed</code></li><li><code>Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource.</code></li><li><code>Unexpected token &#39;C&#39;, &quot;Cross-site&quot;... is not valid JSON</code></li><li>A JSON error response similar to the following:<div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CORS Error: This origin is not allowed.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;requiredOrigin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://localhost:3000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;receivedOrigin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://localhost:3000&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><h2 id="root-cause" tabindex="-1">Root Cause <a class="header-anchor" href="#root-cause" aria-label="Permalink to &quot;Root Cause&quot;">​</a></h2><p>These errors typically occur when the URL you are using to access the application in your browser does not exactly match the <code>APP_URL</code> configured in your <code>.env</code> file.</p><p>This can happen for several reasons:</p><ul><li>You are accessing the application via a different port.</li><li>You are using a reverse proxy that changes the protocol (e.g., from <code>http</code> to <code>https</code>).</li><li>The SvelteKit server, in a production build, is incorrectly guessing its public-facing URL.</li></ul><h2 id="solution" tabindex="-1">Solution <a class="header-anchor" href="#solution" aria-label="Permalink to &quot;Solution&quot;">​</a></h2><p>The solution is to ensure that the application&#39;s frontend and backend are correctly configured with the public-facing URL of your instance. This is done by setting two environment variables: <code>APP_URL</code> and <code>ORIGIN</code>.</p><ol><li><p><strong>Open your <code>.env</code> file</strong> in a text editor.</p></li><li><p><strong>Set <code>APP_URL</code></strong>: Define the <code>APP_URL</code> variable with the exact URL you use to access the application in your browser.</p><div class="language-env vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>APP_URL=http://your-domain-or-ip:3000</span></span></code></pre></div></li><li><p><strong>Set <code>ORIGIN</code></strong>: The SvelteKit server requires a specific <code>ORIGIN</code> variable to correctly identify itself. This should always be set to the value of your <code>APP_URL</code>.</p><div class="language-env vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ORIGIN=$APP_URL</span></span></code></pre></div><p>By using <code>$APP_URL</code>, you ensure that both variables are always in sync.</p></li></ol><h3 id="example-configuration" tabindex="-1">Example Configuration <a class="header-anchor" href="#example-configuration" aria-label="Permalink to &quot;Example Configuration&quot;">​</a></h3><p>If you are running the application locally on port <code>3000</code>, your configuration should look like this:</p><div class="language-env vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>APP_URL=http://localhost:3000</span></span>
<span class="line"><span>ORIGIN=$APP_URL</span></span></code></pre></div><p>If your application is behind a reverse proxy and is accessible at <code>https://archive.mycompany.com</code>, your configuration should be:</p><div class="language-env vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>APP_URL=https://archive.mycompany.com</span></span>
<span class="line"><span>ORIGIN=$APP_URL</span></span></code></pre></div><p>After making these changes to your <code>.env</code> file, you must restart the application for them to take effect:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --force-recreate</span></span></code></pre></div><p>This will ensure that the backend&#39;s CORS policy and the frontend server&#39;s origin are correctly aligned, resolving the errors.</p>`,21)]))}const g=s(t,[["render",n]]);export{u as __pageData,g as default};
